<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OWNID Page Example</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    .row {
      margin: 0 0 16px;
    }
  </style>
  <script>
    window.ownidAsyncInit = function () {
      ownid.init({
        URLPrefix: 'http://localhost:5002/ownid/', // optional. default path is /ownId/
      });

      var ownIdElem1 = ownid.render({
        type: 'register',
        element: document.querySelector('#ownid'),
      });

      ownid.render({
        type: 'login',
        element: document.querySelector('#ownid-login'),
        language: 'ru',
      });

      ownid.render({
        type: 'recover',
        element: document.querySelector('#ownid-recover'),
        data: {
          pwrt: 'pwrtString'
        },
        onRecover: (data) => console.log(data)
      });

      ownid.renderLinkGigya({
        type: 'link',
        element: document.querySelector('#ownid-link'),
      }, '3_s5-gLs4aLp5FXluP8HXs7_JN40XWNlbvYWVCCkbNCqlhW6Sm5Z4tXGGsHcSJYD3W');

      let lang = 'en';

      document.getElementById('destroy')
        .addEventListener('click', () => ownIdElem1.destroy());

      document.getElementById('lang-change')
        .addEventListener('click', () => {
          lang = lang === 'ru' ? 'en' : 'ru';
          ownIdElem1.update({language: lang});
        });

      authFlow();
    };
  </script>
  <script>
    // Authenticate only flow
    function authFlow() {
      const toggleElement = document.getElementById('custom-register-label');
      const ownidWrapperEl = document.getElementById('ownid-toggle-register');
      const authOnlyWidget = ownid.render({
        type: 'register',
        partial: true,
        element: document.getElementById('ownid-toggle-register'),
        toggleElement,
        onRegister: (res) => console.log(res)
      });

      const toggleElements = document.querySelectorAll('[ownid-toggle]');

      document.getElementById('custom-register-check').addEventListener('change', (event) => {

        if (event.target.checked) {
          ownidWrapperEl.style.display = 'block';

          toggleElements.forEach((toggleElement) => {
            const placeholder = document.createElement('ownid-toggle-placeholder');
            placeholder.style.display = 'none';

            toggleElement.parentNode.insertBefore(placeholder, toggleElement);
            toggleElement.parentNode.removeChild(toggleElement);
          });
        } else {
          ownidWrapperEl.style.display = 'none';

          document.querySelectorAll('ownid-toggle-placeholder').forEach((element, index) => {
            element.parentNode.insertBefore(toggleElements[index], element);
            element.parentNode.removeChild(element);
          });
        }
      });
    }
  </script>

  <script async defer src="../dist/ownid-web-ui-sdk.es5.js"></script>

  <style>
    body {
      background: #ccc;
      font-family: sans-serif, serif;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    #main {
      margin-top: 50px;
    }

    .ownid {
      margin: 30px 0;
    }

    #destroy,
    #lang-change {
      border: 1px solid #cccccc;
    }

  </style>
</head>
<body>
<div id="main" class="container">
  <h4 class="">Registration</h4>

  <div id="ownid" class="ownid"></div>

  <h4 class="">Login</h4>

  <button id="lang-change">Set Next lang</button>
  <button id="destroy">Destroy widget</button>

  <div id="ownid-login" class="ownid"></div>

  <h4 class="">Link</h4>

  <div id="ownid-link" class="ownid"></div>

  <h4 class="">Recover</h4>

  <div id="ownid-recover" class="ownid"></div>

  <h4 class="">Custom Register</h4>
  <form>
    <div class="row">
      <input type="name" placeholder="name">
    </div>

    <div class="row">
      <input type="checkbox" id="custom-register-check">
      <label id="custom-register-label" for="custom-register-check">Skip password with OwnID</label>
    </div>

    <div class="row" ownid-toggle>
      <input type="password" placeholder="password">
    </div>

    <div class="row" ownid-toggle>
      <input type="password" placeholder="repeat password">
    </div>

    <div class="row">
      <input type="checkbox" id="terms">
      <label for="terms">terms and conditions</label>
    </div>

    <div class="row" ownid-toggle>
      <button type="button">Submit</button>
    </div>

    <div id="ownid-toggle-register" class="ownid" style="display: none"></div>
  </form>
</div>
</body>
</html>
